{% extends "base.html" %}

{% block title %}Crafts Map of India | VisionCraft{% endblock title %}

{% block content %}
  <div class="crafts-map-container">
    <div class="map-header">
      <a href="{{ url_for('home') }}" class="back-btn">
        <i class="fas fa-arrow-left"></i> Back
      </a>
      <h1>üó∫Ô∏è Crafts Map of India</h1>
      <p>Explore India's rich heritage - Click on any state to discover its signature crafts!</p>
    </div>

    <div class="map-layout">
      <!-- Interactive India Map -->
      <div class="india-map-section">
        <svg id="indiaMap" viewBox="0 0 800 1000" xmlns="http://www.w3.org/2000/svg">
          <!-- Simplified India Map with clickable states -->
          <!-- Rajasthan -->
          <path id="rajasthan" class="state" d="M 150 250 L 250 250 L 280 350 L 200 400 L 150 350 Z" data-state="Rajasthan" />
          <text x="200" y="320" class="state-label">RAJ</text>
          
          <!-- Gujarat -->
          <path id="gujarat" class="state" d="M 100 350 L 200 400 L 180 500 L 80 480 Z" data-state="Gujarat" />
          <text x="140" y="440" class="state-label">GUJ</text>
          
          <!-- Maharashtra -->
          <path id="maharashtra" class="state" d="M 200 500 L 350 480 L 380 580 L 220 600 Z" data-state="Maharashtra" />
          <text x="280" y="540" class="state-label">MAH</text>
          
          <!-- Karnataka -->
          <path id="karnataka" class="state" d="M 220 600 L 380 580 L 350 700 L 200 720 Z" data-state="Karnataka" />
          <text x="280" y="650" class="state-label">KAR</text>
          
          <!-- Tamil Nadu -->
          <path id="tamilnadu" class="state" d="M 300 720 L 380 700 L 400 820 L 320 840 Z" data-state="Tamil Nadu" />
          <text x="340" y="770" class="state-label">TN</text>
          
          <!-- Kerala -->
          <path id="kerala" class="state" d="M 250 750 L 300 720 L 280 840 L 240 850 Z" data-state="Kerala" />
          <text x="265" y="800" class="state-label">KER</text>
          
          <!-- Uttar Pradesh -->
          <path id="uttarpradesh" class="state" d="M 350 150 L 500 140 L 520 250 L 380 260 Z" data-state="Uttar Pradesh" />
          <text x="430" y="200" class="state-label">UP</text>
          
          <!-- Bihar -->
          <path id="bihar" class="state" d="M 500 200 L 600 190 L 610 280 L 520 290 Z" data-state="Bihar" />
          <text x="550" y="240" class="state-label">BIH</text>
          
          <!-- West Bengal -->
          <path id="westbengal" class="state" d="M 600 250 L 680 240 L 700 350 L 620 360 Z" data-state="West Bengal" />
          <text x="640" y="300" class="state-label">WB</text>
          
          <!-- Assam -->
          <path id="assam" class="state" d="M 700 200 L 750 190 L 760 280 L 710 290 Z" data-state="Assam" />
          <text x="720" y="240" class="state-label">ASS</text>
          
          <!-- Jammu & Kashmir -->
          <path id="jammu" class="state" d="M 200 50 L 320 40 L 340 140 L 220 150 Z" data-state="Jammu & Kashmir" />
          <text x="260" y="100" class="state-label">J&K</text>
        </svg>
      </div>

      <!-- State Info Panel -->
      <div class="state-info-panel" id="stateInfoPanel">
        <h2 id="stateName">Select a State</h2>
        <p id="stateDescription">Click on any state on the map to explore its traditional crafts!</p>
        
        <div id="craftsGrid" class="state-crafts-grid" style="display: none;">
          <!-- Crafts will be loaded here dynamically -->
        </div>

        <button id="viewAllBtn" class="view-all-btn" style="display: none;">
          <i class="fas fa-eye"></i> View All Artworks from this State
        </button>
      </div>
    </div>

    <!-- Statistics Section -->
    <div class="map-statistics">
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-map-marked-alt"></i></div>
        <div class="stat-info">
          <h3>28+ States</h3>
          <p>Covering India</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-palette"></i></div>
        <div class="stat-info">
          <h3>100+ Crafts</h3>
          <p>Traditional Arts</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-users"></i></div>
        <div class="stat-info">
          <h3>500+ Artisans</h3>
          <p>Skilled Craftspeople</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-cube"></i></div>
        <div class="stat-info">
          <h3>AR Ready</h3>
          <p>3D Models Available</p>
        </div>
      </div>
    </div>
  </div>

  <style>
    .crafts-map-container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 20px;
    }

    .map-header {
      text-align: center;
      margin-bottom: 40px;
      position: relative;
    }

    .map-header .back-btn {
      position: absolute;
      left: 0;
      top: 0;
      background: var(--card-bg);
      padding: 10px 20px;
      border-radius: 12px;
      text-decoration: none;
      color: var(--card-text);
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .map-header h1 {
      font-size: 2.8rem;
      color: var(--card-text);
      margin-bottom: 10px;
    }

    .map-header p {
      color: var(--card-text);
      opacity: 0.8;
      font-size: 1.2rem;
    }

    .map-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 40px;
    }

    .india-map-section {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 30px;
      box-shadow: var(--elevation-3);
    }

    #indiaMap {
      width: 100%;
      height: auto;
    }

    .state {
      fill: rgba(102, 126, 234, 0.3);
      stroke: var(--color-primary);
      stroke-width: 2;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .state:hover {
      fill: rgba(102, 126, 234, 0.6);
      stroke-width: 3;
      filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.8));
    }

    .state.selected {
      fill: var(--color-primary);
      stroke: var(--color-accent);
      stroke-width: 4;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .state-label {
      fill: white;
      font-size: 14px;
      font-weight: 700;
      text-anchor: middle;
      pointer-events: none;
    }

    .state-info-panel {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 30px;
      box-shadow: var(--elevation-3);
      min-height: 500px;
    }

    .state-info-panel h2 {
      color: var(--card-text);
      font-size: 2.2rem;
      margin-bottom: 15px;
    }

    .state-info-panel p {
      color: var(--card-text);
      opacity: 0.8;
      font-size: 1.1rem;
      margin-bottom: 25px;
    }

    .state-crafts-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .craft-item {
      background: var(--glass-bg);
      border-radius: 16px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .craft-item:hover {
      transform: translateY(-5px);
      box-shadow: var(--elevation-3);
      border-color: var(--color-primary);
    }

    .craft-item img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 10px;
    }

    .craft-item h4 {
      color: var(--card-text);
      margin: 8px 0 4px 0;
      font-size: 1rem;
    }

    .craft-item p {
      color: var(--card-text);
      opacity: 0.7;
      font-size: 0.85rem;
      margin: 0;
    }

    .view-all-btn {
      width: 100%;
      background: var(--color-primary);
      color: white;
      border: none;
      padding: 15px;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .view-all-btn:hover {
      background: var(--color-accent);
      transform: translateY(-2px);
      box-shadow: var(--elevation-3);
    }

    /* Statistics Section */
    .map-statistics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .stat-card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 25px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: var(--elevation-2);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--elevation-4);
    }

    .stat-icon {
      font-size: 3rem;
      color: var(--color-primary);
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--glass-bg);
      border-radius: 50%;
    }

    .stat-info h3 {
      color: var(--card-text);
      margin: 0 0 5px 0;
      font-size: 1.8rem;
    }

    .stat-info p {
      color: var(--card-text);
      opacity: 0.7;
      margin: 0;
      font-size: 1rem;
    }

    @media (max-width: 1024px) {
      .map-layout {
        grid-template-columns: 1fr;
      }

      .state-crafts-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .map-header h1 {
        font-size: 2rem;
      }

      .state-crafts-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <script>
    // State Crafts Data
    const stateCrafts = {
      "Rajasthan": {
        description: "Famous for blue pottery, block printing, and miniature paintings",
        crafts: [
          { name: "Blue Pottery", artId: 11, image: "https://placehold.co/200x200/4169E1/ffffff?text=Blue+Pottery" },
          { name: "Silver Jewelry", artId: 10, image: "https://placehold.co/200x200/C0C0C0/000000?text=Silver" },
          { name: "Terracotta", artId: 1, image: "https://placehold.co/200x200/8B4513/ffffff?text=Pottery" }
        ]
      },
      "Gujarat": {
        description: "Known for Bandhani textiles, embroidery, and handicrafts",
        crafts: [
          { name: "Indigo Textiles", artId: 4, image: "https://placehold.co/200x200/3c5a77/ffffff?text=Indigo" }
        ]
      },
      "Maharashtra": {
        description: "Home to Warli art, Paithani sarees, and Kolhapuri chappals",
        crafts: [
          { name: "Warli Art", artId: 9, image: "https://placehold.co/200x200/8B7355/ffffff?text=Warli" }
        ]
      },
      "Karnataka": {
        description: "Famous for Channapatna toys, Mysore silk, and sandalwood crafts",
        crafts: [
          { name: "Wooden Toys", artId: 2, image: "https://placehold.co/200x200/D2691E/ffffff?text=Toys" }
        ]
      },
      "Tamil Nadu": {
        description: "Known for Tanjore paintings, bronze sculptures, and silk sarees",
        crafts: [
          { name: "Bronze Sculpture", artId: 5, image: "https://placehold.co/200x200/8B4513/ffffff?text=Bronze" }
        ]
      },
      "Kerala": {
        description: "Famous for bell metal crafts, Kathakali masks, and coir products",
        crafts: [
          { name: "Temple Bell", artId: 8, image: "https://placehold.co/200x200/FFD700/000000?text=Bell" }
        ]
      },
      "Bihar": {
        description: "Home to Madhubani paintings and Sikki grass crafts",
        crafts: [
          { name: "Madhubani Art", artId: 6, image: "https://placehold.co/200x200/FF6347/ffffff?text=Madhubani" }
        ]
      },
      "Assam": {
        description: "Known for bamboo and cane crafts, silk weaving",
        crafts: [
          { name: "Bamboo Weave", artId: 3, image: "https://placehold.co/200x200/8B7355/ffffff?text=Bamboo" }
        ]
      },
      "Jammu & Kashmir": {
        description: "Famous for Papier-m√¢ch√©, carpets, and pashmina shawls",
        crafts: [
          { name: "Papier-M√¢ch√©", artId: 7, image: "https://placehold.co/200x200/DAA520/000000?text=Papier+Mache" }
        ]
      },
      "West Bengal": {
        description: "Known for Terracotta, Kantha embroidery, and Dokra art",
        crafts: []
      },
      "Uttar Pradesh": {
        description: "Famous for Chikan embroidery, brassware, and carpet weaving",
        crafts: []
      }
    };

    // Initialize map interactions
    const states = document.querySelectorAll('.state');
    const stateName = document.getElementById('stateName');
    const stateDescription = document.getElementById('stateDescription');
    const craftsGrid = document.getElementById('craftsGrid');
    const viewAllBtn = document.getElementById('viewAllBtn');

    states.forEach(state => {
      state.addEventListener('click', function() {
        const selectedState = this.getAttribute('data-state');
        selectState(selectedState);
      });
    });

    function selectState(state) {
      // Remove previous selection
      states.forEach(s => s.classList.remove('selected'));
      
      // Select new state
      document.getElementById(state.toLowerCase().replace(/\s+/g, '').replace('&', ''))?.classList.add('selected');

      const stateData = stateCrafts[state];
      
      if (stateData) {
        stateName.textContent = state;
        stateDescription.textContent = stateData.description;
        
        if (stateData.crafts.length > 0) {
          craftsGrid.style.display = 'grid';
          viewAllBtn.style.display = 'flex';
          
          craftsGrid.innerHTML = stateData.crafts.map(craft => `
            <div class="craft-item" onclick="window.location.href='/art/${craft.artId}'">
              <img src="${craft.image}" alt="${craft.name}">
              <h4>${craft.name}</h4>
              <p>View Details</p>
            </div>
          `).join('');
          
          viewAllBtn.onclick = () => {
            window.location.href = `/home?state=${encodeURIComponent(state)}`;
          };
        } else {
          craftsGrid.style.display = 'none';
          viewAllBtn.style.display = 'none';
          stateDescription.textContent += ' More artworks coming soon!';
        }
        
        showToast(`Exploring ${state}!`, 'info');
      }
    }

    // Auto-select Rajasthan on load
    setTimeout(() => {
      selectState('Rajasthan');
    }, 500);
  </script>
{% endblock content %}
